<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<body>

<!-- content -->
<th:block th:replace="~{./include/baselayout :: setContent( ~{ :: .bon-wrap } )}">
    <div class="bon-wrap">
        <div class="page-title">
            <p>그룹</p>
        </div>
        <div class="route-wrap">
            <a href="#">그룹</a><p>/</p><a href="/group/groupList">내 학습그룹</a><p>/</p><a style="color: black;">[[${group.group_nm}]]</a>
        </div>
        <div class="ul-wrap-m">
            <ul class="toggle-m2">
                <li data-id="#tog-m1" class="acts-m">대시보드</li>
                <li data-id="#tog-m2" class="">상세</li>
            </ul>
        </div>
        <div class="te-wrap-m toggle-menu-m active-m2" id="tog-m1" >
            <div class="left-te-wrap">
                <div class="left-top-te cum-m">
                    <div class="ltt-up-wrap-m">
                        <h5>수행률 분포</h5>
                        <div class="ltt-wrap">
                            <p>아래쪽 그래프는 각 구성원 수행률을 나타냅니다.</p>
                        </div>
                    </div>
                    <div class="chart-wrap-m">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
                <div class="left-bot-te">
                    <div class="bot-te-left cum-m">
                        <div class="ltt-up-wrap-m">
                            <h5>구간별 구성원 수</h5>
                            <div class="ltt-wrap">
                                <p>구간별 구성원 수를 통해 수행률별 분포를 알 수 있습니다.</p>
                            </div>
                        </div>
                        <div class="chart-scd-wrap-m">
                            <div class="chart-wrap-m" style="width: 90%; flex-basis: 70%;">
                                <canvas id="myChart-lb"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="bot-te-right cum-m">
                        <div class="ltt-up-wrap-m">
                            <h5>기록</h5>
                            <div class="ltt-wrap">
                                <p>기록 영역에서는 네 개 부문에서
                                    주목해야 할 학생을 보여줍니다. </p>
                            </div>
                        </div>
                        <div class="reco-wrap-m">
                            <div class="reco-content-m">
                                <h4>코드실행이 가장많은 구성원</h4>
                                <p class="bb-m-m"></p>
                            </div>
                            <div class="reco-content-m">
                                <h4>점수가 가장높은 구성원</h4>
                                <p class="bb-w-m"></p>
                            </div>
                            <div class="reco-content-m">
                                <h4>코드실행이 가장적은 구성원</h4>
                                <p class="bp-m-m"></p>
                            </div>
                            <div class="reco-content-m">
                                <h4>점수가 가장낮은 구성원</h4>
                                <p class="bp-w-m"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="right-te-wrap">
                <div class="right-top-te cum-m" style="gap: 17px">
                    <div class="ltt-up-wrap-m">
                        <h5>난이도별 평가</h5>
                        <div class="ltt-wrap">
                            <p>아래쪽 그래프는 난이도별 정답률을 나타냅니다.</p>
                        </div>
                    </div>
                    <div class="chart-scd-wrap-m">
                        <div class="chart-wrap-m" style="width: 70%; flex-basis: 59%;">
                            <canvas id="myChart-lls"></canvas>
                        </div>
                    </div>
                </div>
                <div class="right-bot-te cum-m">
                    <div class="ltt-up-wrap-m">
                        <h5>일일 수행률</h5>
                        <h3 class="per-m-m"></h3>
                        <p class="per-m-content"></p>
                        <div class="ltt-wrap">
                            <p>배부된 숙제 중 구성원이 얼마나 풀었는지 나타내는 지표입니다. </p>
                        </div>
                    </div>
                    <div class="chart-wrap-m">
                        <canvas id="myChart-ll"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="toggle-menu-m" id="tog-m2">
        <div class="bon-content-wrap " style="width: 100%">
            <div class="box-title-wrap">
                <h3>학습 그룹 상세</h3>

            </div>

            <div class="content-box handle-h3">
                <h3 style="margin-bottom: 10px;">[[${group.group_nm}]]</h3>
                <div class="reg-title-wrap" style="margin-bottom: 15px;">
                    <div class="like-table-wrap">
                        <div class="sinfo-wrap-m">
                            <p>교육자명</p>
                            <h4 class="name-m"><i class="ri-user-star-line"></i>&nbsp;[[${group.korn_flnm}]]</h4>
                        </div>
                        <div class="sinfo-wrap-m">
                            <p>구독등급</p>
                            <h4 class="name-m"><i class="ri-file-user-line"></i> &nbsp;[[${membervo.tier}]]</h4>
                        </div>
                        <div class="sinfo-wrap-m">
                            <p>기간</p>
                            <h4 class="name-m"><i class="ri-calendar-check-line"></i> &nbsp;[[${#dates.format(group.group_start, 'yyyy.MM.dd')}]]~[[${#dates.format(group.group_end, 'yyyy.MM.dd')}]]</h4>
                        </div>
                        <div class="sinfo-wrap-m">
                            <p>그룹원</p>
                            <h4 class="name-m"><i class="ri-group-line"></i> &nbsp;[[${group.student_count}]]</h4>
                        </div>
                        <div class="sinfo-wrap-m">
                            <p>질문</p>
                            <h4 class="name-m"><i class="ri-questionnaire-line"></i> &nbsp;[[${group.std_q}]]</h4>
                        </div>
                        <div class="sinfo-wrap-m">
                            <p>수업자료</p>
                            <h4 class="name-m"><i class="ri-file-line"></i> &nbsp;[[${group.group_mt}]]</h4>
                        </div>
                    </div>
                </div>
                <h3 style="margin-bottom: 10px;">학생정보 <i class="ri-arrow-down-s-fill"></i></h3>
                <div class="reg-title-wrap">
                    <div class="content-box">
                        <div class="top-line-btn-wrap">
                            <div style="display: flex; gap: 10px; align-items: start">
                                <input type="text" class="search-m"  placeholder="학생이름을 검색해주세요">
                                <i class="ri-search-line" style="top: 3px"></i>
                                <div class="ssd-mm" style="margin: 0">
                                    <input type="button" class="sub-des" id="sc-btn-m" style="padding: 4px 15px; font-size: 13px;" value="조회하기">
                                </div>
                            </div>
                            <button type="button" id="del-std" style="background-color: #db666b">퇴장</button>
                        </div>
                        <div class="wr-m">
                            <p><i class="ri-error-warning-line"></i>학생이 회원탈퇴를 하면 자동으로 목록에서 삭제가 됩니다</p>
                        </div>
                        <div class="table-wrap">
                            <table class="table-content">
                                <thead class="co-head">
                                <tr class="co-flex">
                                    <th class="coco crcr-0">#<input type="hidden" class="gno-m" name="group_no" th:value="${group.group_no}"></th>
                                    <th class="coco srsc-1 lis-left desc-tr">이름 <i class="ri-arrow-down-s-fill i-col"></i></th>
                                    <th class="coco srsc-2 lis-left desc-tr">연락처<i class="ri-arrow-down-s-fill"></i></th>
                                    <th class="coco srsc-3 lis-left desc-tr">이메일<i class="ri-arrow-down-s-fill"></i></th>
                                    <th class="coco srsc-4 lis-left desc-tr">학습점수<i class="ri-arrow-down-s-fill"></i></th>
                                    <th class="coco srsc-5 lis-left desc-tr">숙제제출<i class="ri-arrow-down-s-fill"></i></th>
                                </tr>
                                </thead>
                                <tbody class="co-body sms-m">
                                <th:block th:each="list : ${std}">
                                <tr class="co-flex">
                                    <td class="coco crcr-0 center-flex"><input type="checkbox" name="login_id" class="lolo-m" th:value="${list.login_id}"></td>
                                    <td class="coco srsc-1 lis-left">[[${list.korn_flnm}]]</td>
                                    <td class="coco srsc-2 lis-left">[[${list.idfr_telno}]]</td>
                                    <td class="coco srsc-3 lis-left">[[${list.adm_eml_addr}]]</td>
                                    <td class="coco srsc-4 lis-left">[[${list.score}]]</td>
                                    <td class="coco srsc-5 lis-left detail-btw"><span>[[${list.submitted_count + list.not_submitted_count}]]/[[${list.submitted_count}]]</span><button class="join-btn rp-m" type="button">자세히</button></td>
                                </tr>
                                </th:block>




                                </tbody>
                            </table>
                        </div>
                        <div class="page-wrap right-p sms-mdd">
                            <div class="pagination">
                                <a href="#">&laquo;</a>
                                <th:block th:each="page : ${pageVO.pageList}">
                                    <a th:class="${pageVO.page == page ? 'act':''}" th:data-page="${page}">[[${page}]]</a>
                                </th:block>
                                <a href="#">&raquo;</a>
                            </div>
                        </div>

                    </div>

                </div>

                <h3 style="margin-bottom: 10px;">수업자료 <i class="ri-arrow-down-s-fill"></i></h3>
                <div class="reg-title-wrap">
                    <div class="content-box">
                        <div class="top-line-btn-wrap">
                            <div div style="display: flex; gap: 10px; align-items: start">
                                <input type="text" class="search-m2" placeholder="제목을 검색해주세요">
                                <i class="ri-search-line"></i>
                                <div class="ssd-mm2" style="margin: 0">
                                    <input type="button" class="sub-des" id="sc-btn-m2" style="padding: 4px 15px; font-size: 13px;" value="조회하기">
                                </div>
                            </div>
                        </div>
                        <div class="wr-m">
                            <p><i class="ri-error-warning-line"></i>수업자료 페이지에서 수업자료를 업로드 할 수 있습니다.</p>
                        </div>
                        <div class="table-wrap">
                            <table class="table-content">
                                <thead class="co-head">
                                <tr class="co-flex">
                                    <th class="coco crcr-0">No</th>
                                    <th class="coco mrmr-1m lis-left desc-tr">제목<i class="ri-arrow-down-s-fill i-col"></i></th>
                                    <th class="coco mrmr-2m lis-left desc-tr">강의유형<i class="ri-arrow-down-s-fill"></i></th>
                                    <th class="coco mrmr-3m lis-left desc-tr">등록일시<i class="ri-arrow-down-s-fill"></i></th>
                                </tr>
                                </thead>
                                <tbody class="co-body sms-m2">
                                <th:block th:each="i,status : ${data}">
                                <tr class="co-flex">
                                    <td class="coco crcr-0 center-flex">[[${status.index + 1}]]</td>
                                    <td class="coco mrmr-1m lis-left">[[${i.gfilename}]]</td>
                                    <td class="coco mrmr-2m lis-left">[[${i.gname}]]</td>
                                    <td class="coco mrmr-3m lis-left">[[${#temporals.format(i.gregdate, 'yyyy.MM.dd')}]]</td>
                                </tr>

                                </th:block>



                                </tbody>
                            </table>
                        </div>
                        <div class="page-wrap right-p sms-mdd2">
                            <div class="pagination">
                                <a href="#">&laquo;</a>
                                <th:block th:each="page : ${pageVO2.pageList}">
                                    <a th:class="${pageVO2.page == page ? 'act':''}" th:data-page="${page}">[[${page}]]</a>
                                </th:block>
                                <a href="#">&raquo;</a>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
        </div>
        </div>
        <div id="modalfour" class="hidden">
            <div id="modalcontentt" style="width: 950px">
                <div class="modal-wrap-m">
                    <div class="join-wrap-mm">
                        <div class="top-inp">
                            <h3><i class="ri-checkbox-circle-line"></i>숙제 이력 확인</h3>
                        </div>
                    </div>

                    <div class="content-box">
                        <div class="wr-m">
                            <p><i class="ri-error-warning-line"></i>거절을 누르면 자동으로 목록에서 삭제가 됩니다</p>
                        </div>
                        <div class="table-wrap">
                            <table class="table-content">
                                <thead class="co-head">
                                <tr class="co-flex">
                                    <th class="coco crcr-0">#</th>
                                    <th class="coco hm-mm-1">숙제명</th>
                                    <th class="coco hm-mm-2">언어</th>
                                    <th class="coco hm-mm-22">레벨</th>
                                    <th class="coco hm-mm-3">제출일</th>
                                    <th class="coco hm-mm-4">마감기한</th>
                                    <th class="coco hm-mm-5">점수</th>
                                    <th class="coco hm-mm-6">상태</th>
                                </tr>
                                </thead>
                                <tbody class="co-body sms-ddd">


                                </tbody>
                            </table>
                        </div>
                        <div class="bot-sub-m">
                            
                            <button id="close-m" type="button">닫기</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</th:block>

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
<script th:inline="javascript">
    var list =JSON.parse(`[[${list}]]`);
    console.log(list);

    var label = [];
    var dataweek = [];
    const labels = [];
    const mydata = [];
    const alldata = [];
    const lvlabels = [];
    const lvdata = [];
    const query1Data = [];

    for (let i = 0; i < list.length; i++) {
        if (list[i].query_type == "query1") {
            query1Data.push(list[i]); // query1 데이터만 따로 배열에 저장
        } else if (list[i].query_type == "query2") {
            labels.push(list[i].korn_flnm);
            mydata.push(list[i].num);
        } else if (list[i].query_type == "query3") {
            alldata.push(list[i].num);
        } else if (list[i].query_type == "query4") {
            lvlabels.push(list[i].korn_flnm);
            lvdata.push(list[i].num);
        } else if (list[i].query_type == "query5") {
            $(".bb-m-m").html(`${list[i].korn_flnm}<span>(${list[i].num}회)</span>`)
        } else if (list[i].query_type == "query6") {
            $(".bp-m-m").html(`${list[i].korn_flnm}<span>(${list[i].num}회)</span>`)
        } else if (list[i].query_type == "query7") {
            $(".bb-w-m").html(`${list[i].korn_flnm}<span>(${list[i].num}점)</span>`)
        } else if (list[i].query_type == "query8") {
            $(".bp-w-m").html(`${list[i].korn_flnm}<span>(${list[i].num}점)</span>`)
        }
    }

    // query1 데이터를 num 기준으로 정렬
    query1Data.sort((a, b) => a.num - b.num);

    // 정렬된 query1 데이터로 label과 dataweek 배열 재구성
    for (let i = 0; i < query1Data.length; i++) {
        label.push(query1Data[i].korn_flnm);
        if (query1Data[i].num != null) dataweek.push(query1Data[i].num);
        else dataweek.push(0);
    }
    var nowdata = mydata[0];
    $(".per-m-m").html(`${nowdata}\%`);
    console.log(nowdata);
    console.log(mydata);
    var ctx = document.getElementById('myChart');
    var ctx2 = document.getElementById('myChart-lb');
    labels.reverse();
    mydata.reverse();
    alldata.reverse();




    var sum = dataweek.reduce((acc, cur) => acc + cur, 0);
    var average = sum / dataweek.length;


    var mavg = Math.round(average);
    if(nowdata - mavg > 0) $(".per-m-content").html(`<span style="color: #4ca970; font-weight: 600;"><i class="ri-arrow-up-line"></i>${nowdata - mavg}%</span> vs group avg`)
    else if (nowdata - mavg < 0) $(".per-m-content").html(`<span style="color: #ef5050; font-weight: 600;"><i class="ri-arrow-down-line"></i>${nowdata - mavg}%</span> vs group avg`)
    else $(".per-m-content").html(`<span>${nowdata - mavg}%</span> vs group avg`)
    const data2 = {
        labels: label,
        datasets: [
            {
                label: '평균',
                data: Array(label.length).fill(average), // 평균값으로 이루어진 배열 생성
                borderColor: '#f54242', // 평균값 선 색상
                borderWidth: 2,
                borderDash: [5, 5], // 점선 스타일 설정
                type: 'line', // 라인 차트로 설정
                fill: false, // 라인 아래를 채우지 않음
                pointRadius: 0 // 데이터 포인트를 숨김
            },
            {
                label: '그룹원',
                data: dataweek,
                backgroundColor: '#73a2ef', // 데이터 포인트의 배경색을 동일하게 설정
                borderWidth: 1,
                borderRadius: 4,
                barPercentage: 0.9,
                categoryPercentage: 0.9,
                type: 'bar' // 막대 그래프로 설정
            }
        ]
    };

    new Chart(ctx, {
        type: 'bar',
        data: data2
        ,
        options: {
            responsive: true,
            maintainAspectRatio: false, // false로 설정하여 차트 크기를 조절
            scales: {
                x: {
                    grid: {
                        display: false // x축의 그리드 선 숨기기
                    }
                },
                y: {
                    beginAtZero: true,
                    max: 100, // y축의 최대값
                    grid: {
                        display: false // y축의 그리드 선 숨기기
                    },
                    ticks: {
                        beginAtZero: true,
                        max: 100

                    }
                }
            },
            layout: {
                padding: 10
            },
            cornerRadius: 20
        }
    });

    var cnum1 = 0;
    var cnum2 = 0;
    var cnum3 = 0;
    var cnum4 = 0;
    if(dataweek[0] != null){
        dataweek.forEach(function(value) {
            if (value <= 40) {
                cnum1++;
            } else if (value <= 75) {
                cnum2++;
            } else if (value <= 90) {
                cnum3++;
            } else {
                cnum4++;
            }
        });
    }
    const datacon = [cnum1,cnum2,cnum3,cnum4]

    new Chart(ctx2,{
        type: 'doughnut',
        data: {
            labels: [
                '~40%',
                '~75%',
                '~90%',
                '90%~'
            ],
            datasets: [{
                label: 'My First Dataset',
                data: datacon,
                backgroundColor: [
                    '#F99C30',
                    '#2FBFDE',
                    '#3A4DE9',
                    'rgba(255, 99, 132, 1)'
                ],
                hoverOffset: 4
            }]

        }
    });




    const data = {
        labels: labels,
        datasets: [
            {
                label: '이그룹 수행률',
                data: mydata,
                borderColor: "#5A6ACF",
                backgroundColor: "#5A6ACF",
            },
            {
                label: '모든그룹 수행률',
                data: alldata,
                borderColor: "#E6E8EC",
                backgroundColor: "#E6E8EC",
            }
        ]
    };

    const config = {
        type: 'line',
        data: data,
        options: {
            responsive: true,
            plugins: {

            },
            scales: {
                y: {
                    suggestedMin: 0,
                    suggestedMax: 100,
                }
            }
        },
    };

    const ctx3 = document.getElementById('myChart-ll');

    let myChart;

    myChart = new Chart(ctx3, config);

    const ctx4 = document.getElementById('myChart-lls');

    new Chart(ctx4,{
        type: 'doughnut',
        data: {
            labels: lvlabels,
            datasets: [{
                label: 'My First Dataset',
                data: lvdata,
                backgroundColor: [
                    '#2189FF',
                    '#1BBAFF',
                    '#47C84C',
                    '#FFA800',
                    '#FF6B18',
                    '#C658E1'
                ],
                hoverOffset: 4
            }]

        }
    });
</script>


<script>
    var tog = document.querySelector('.toggle-m2');
    var prei = '#tog-m1';
    tog.addEventListener('click', (e)=>{

        if(e.target.tagName != 'LI') return;
        var preto = document.querySelector('.acts-m');
        var menu = e.target.dataset.id;
        var ddd = document.querySelector(menu);
        var pp = document.querySelector(prei);
        preto.classList.toggle('acts-m');
        e.target.classList.toggle('acts-m');

        pp.classList.toggle('active-m2');
        ddd.classList.toggle('active-m2');
        prei = menu;

    })








    const group_no = $(".gno-m").val();
    $(document).ready(function() {
        $(".handle-h3").on('click', "h3", function(e){

            var result = $(this).next().find(".content-box").css("display");
            if(result == "flex") {
                $(this).next().find(".content-box").slideUp();
            } else {
                $(this).next().find(".content-box").slideDown();
            }

        });


    });








    function getstdinfo(searchKorn_flnm, page, group_no) {
        $.ajax({
            type: "GET",
            url: "/getgroupstdInfo",
            dataType: "json",
            data: {
                searchKorn_flnm: searchKorn_flnm,
                page: page,
                amount: 5,
                group_no: group_no
            },
            success: function (data) {
                console.log(data);
                $(".sms-m").empty();
                for (let i of data) {
                    var tr = document.createElement("tr");
                    tr.classList.add("co-flex");
                    tr.innerHTML = `<td class="coco crcr-0 center-flex"><input type="checkbox" class="lolo-m" name="login_id" value="${i.login_id}"></td>
                                    <td class="coco srsc-1 lis-left">${i.korn_flnm}</td>
                                    <td class="coco srsc-2 lis-left">${i.idfr_telno}</td>
                                    <td class="coco srsc-3 lis-left">${i.adm_eml_addr}</td>
                                    <td class="coco srsc-4 lis-left">${i.score}</td>
                                    <td class="coco srsc-5 lis-left detail-btw"><span>${i.submitted_count + i.not_submitted_count}/${i.submitted_count}</span><button class="join-btn rp-m" type="button">자세히</button></td>`;
                    $(".sms-m").append(tr);
                }
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                alert("정보를 불러올 수 없습니다.");
            }
        });
    }

    function getdatainfo(searchKorn_flnm, page, group_no) {
        $.ajax({
            type: "GET",
            url: "/getgroupdataInfo",
            dataType: "json",
            data: {
                searchKorn_flnm: searchKorn_flnm,
                page: page,
                amount: 5,
                group_no: group_no
            },
            success: function (data) {
                console.log(data);
                $(".sms-m2").empty();
                for (let i in data) {
                    var tr = document.createElement("tr");
                    tr.classList.add("co-flex");
                    var joinDate = new Date(data[i].gregdate);

                    // 원하는 포맷으로 날짜 및 시간 출력
                    var formattedJoinDate = joinDate.toLocaleString();
                    tr.innerHTML = `<td class="coco crcr-0 center-flex">${parseInt(i) + 1}</td>
                                    <td class="coco mrmr-1m lis-left">${data[i].gfilename}</td>
                                    <td class="coco mrmr-2m lis-left">${data[i].gname}</td>
                                    <td class="coco mrmr-3m lis-left">${formattedJoinDate}</td>`;
                    $(".sms-m2").append(tr);
                }
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                alert("정보를 불러올 수 없습니다.");
            }
        });
    }


    function getstdinfopage(searchKorn_flnm, page, group_no) {
        $.ajax({
            type: "GET",
            url: "/getgroupstdInfopage",
            dataType: "json",
            data: {
                searchKorn_flnm: searchKorn_flnm,
                page: page,
                amount: 5,
                group_no: group_no
            },
            success: function (data) {
                console.log(data);
                $(".sms-mdd").empty();
                var div = document.createElement("div");
                var a1 = document.createElement("a");
                a1.innerHTML = "&laquo;"
                div.append(a1);

                div.classList.add("pagination");
                for (let i of data.pageList) {
                    var a = document.createElement("a");
                    if(data.page == i) a.classList.add("act");
                    a.setAttribute("data-page", i); // 데이터 속성 설정
                    a.innerHTML = i;
                    div.append(a);
                }
                var a2 = document.createElement("a");
                a2.innerHTML = "&raquo;"
                div.append(a2);
                $(".sms-mdd").append(div);
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                alert("정보를 불러올 수 없습니다.");
            }
        });
    }
    function getdatainfopage(searchKorn_flnm, page, group_no) {
        $.ajax({
            type: "GET",
            url: "/getgroupdataInfopage",
            dataType: "json",
            data: {
                searchKorn_flnm: searchKorn_flnm,
                page: page,
                amount: 5,
                group_no: group_no
            },
            success: function (data) {
                console.log(data);
                $(".sms-mdd2").empty();
                var div = document.createElement("div");
                var a1 = document.createElement("a");
                a1.innerHTML = "&laquo;"
                div.append(a1);

                div.classList.add("pagination");
                for (let i of data.pageList) {
                    var a = document.createElement("a");
                    if(data.page == i) a.classList.add("act");
                    a.setAttribute("data-page", i); // 데이터 속성 설정
                    a.innerHTML = i;
                    div.append(a);
                }
                var a2 = document.createElement("a");
                a2.innerHTML = "&raquo;"
                div.append(a2);
                $(".sms-mdd2").append(div);
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                alert("정보를 불러올 수 없습니다.");
            }
        });
    }




    function gethomeworkinfo(login_id) {
        $.ajax({
            type: "POST",
            url: "/gethomeworkinfo",
            data: JSON.stringify({
                login_id: login_id,

            }),
            contentType: "application/json",
            success: function (data) {
                $(".sms-ddd").empty();
                console.log(data);
                for (let i in data) {
                    var tr = document.createElement("tr");
                    tr.classList.add("co-flex");
                    tr.innerHTML = `<td class="coco crcr-0">${parseInt(i) + 1}</td>
                                    <td class="coco hm-mm-1">${data[i].homework_title}</td>
                                    <td class="coco hm-mm-2">${data[i].homework_language}</td>
                                    <td class="coco hm-mm-22">${data[i].homework_level}</td>
                                    <td class="coco hm-mm-3">${data[i].homework_recieve == null ? '':data[i].homework_recieve}</td>
                                    <td class="coco hm-mm-4">${data[i].homework_enddate}</td>
                                    <td class="coco hm-mm-5">${data[i].homework_score}</td>
                                    <td class="coco hm-mm-6">${data[i].homework_st}</td>`;
                    $(".sms-ddd").append(tr);
                }
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                alert("정보를 불러올 수 없습니다.");
            }
        });
    }









    $("#del-std").click(function(){
        if(!confirm("정말 퇴장처리 하시겠습니까?")) return
        // 선택된 학생들의 login_id를 담을 배열
        var selectedStudents = [];

        // 각 체크된 checkbox에서 login_id를 가져와 배열에 추가
        $("input[name='login_id']:checked").each(function(){
            selectedStudents.push($(this).val());
        });

        // AJAX를 통해 서버로 선택된 학생들의 login_id 전송
        $.ajax({
            url: '/stddel', // 서버의 컨트롤러 URL
            type: 'GET', // GET 방식
            data: {login_ids: selectedStudents.join(','), group_no: group_no }, // 선택된 학생들의 login_id 전달
            success: function(response){
                alert("퇴장처리하였습니다");
                // 서버에서의 처리가 성공했을 때의 동작
                // 예를 들어, 퇴장 처리 후 화면 갱신 등의 동작을 수행할 수 있음
                location.reload(); // 페이지 새로고침
            },
            error: function(xhr, status, error){
                // 서버에서의 처리가 실패했을 때의 동작
                console.error(error); // 에러 로그 출력
            }
        });
    });

    $(".sms-mdd").on("click", 'a',function (e){
        console.log($(this).data("page"));
        var searchname = $(".search-m").val();
        $(".sms-m").empty();
        getstdinfo(searchname, $(this).data("page"), group_no);
        getstdinfopage(searchname, $(this).data("page"), group_no);
    })

    $(".sms-mdd2").on("click", 'a',function (e){
        console.log($(this).data("page"));
        var searchname2 = $(".search-m2").val();
        $(".sms-m2").empty();
        getdatainfo(searchname2, $(this).data("page"), group_no);
        getdatainfopage(searchname2, $(this).data("page"), group_no);
    })

    $("#sc-btn-m").on('click', function (e){
        var searchname = $(".search-m").val();
        $(".sms-m").empty();
        getstdinfo(searchname, $(this).data("page"), group_no);
        getstdinfopage(searchname, $(this).data("page"), group_no);
    })
    $("#sc-btn-m2").on('click', function (e){
        var searchname = $(".search-m2").val();
        $(".sms-m2").empty();
        getdatainfo(searchname, $(this).data("page"), group_no);
        getdatainfopage(searchname, $(this).data("page"), group_no);
    })



    $(".sms-m").on('click','.rp-m', function (e){
        console.log($(this).closest(".co-flex").find(".lolo-m").val());
        gethomeworkinfo($(this).closest(".co-flex").find(".lolo-m").val());
        $("#modalfour").removeClass('hidden');
    })
    document.getElementById("close-m").addEventListener('click', ()=>{
        $("#modalfour").addClass('hidden');

    })

</script>
</body>
</html>